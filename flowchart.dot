digraph {

    node [shape=box];

    Start [shape=box, style=rounded];
    Step1 [label="preproccessing: remove adapter"];
    Step2 [label="extract hookers(sub part of reads, for do alignment.)"];
    Step3 [label="mapping hookers use BWA"];
    Step5 [label="creat matrix"];
    Step6 [label="ICE adjustment"];
    isTrim [shape=diamond, label="reads with barcode?"]
    Trim [label="trim barcode"]
    End [shape=box, style=rounded];

    subgraph clusterStep4 {
        s1 [label="filter out low quality mapping reads."];
        s2 [label="join left right mapping results together."];
        s3 [label="remove redundancy."];
        s4 [label="noise reduction."];
        s1 -> s2 -> s3 -> s4;
    }

    Start -> Step1;
    Step1 -> Step2 -> isTrim;
    isTrim -> Step3 [label="N"];
    isTrim -> Trim  [label="Y"];
    Trim -> Step3;
    Step3 -> s1;
    s4 -> Step5 -> Step6;
    Step6 -> End;

}
